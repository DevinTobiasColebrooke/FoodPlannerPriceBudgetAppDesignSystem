<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Food Planner - Allergies & Sensitivities</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Satisfy&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; color: #111827; }
        .font-display-prototype { font-family: 'Satisfy', cursive; }
        .text-shadow-dark-prototype { text-shadow: 0px 2px 3px rgba(0, 0, 0, 0.2); }
        .form-checkbox-custom { appearance: none; width: 1.25rem; height: 1.25rem; border: 2px solid #D1D5DB; border-radius: 0.25rem; display: inline-block; vertical-align: middle; position: relative; cursor: pointer; flex-shrink: 0; }
        .form-checkbox-custom:checked { background-color: #5AD479; border-color: #5AD479; }
        .form-checkbox-custom:checked::after { content: '✓'; font-size: 0.9rem; color: white; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .tag-input-container { display: flex; flex-wrap: wrap; gap: 0.5rem; padding: 0.5rem; border: 1px solid #D1D5DB; border-radius: 0.5rem; background-color: white; }
        .tag { display: inline-flex; align-items: center; background-color: #5AD479; color: white; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.875rem; }
        .tag button { margin-left: 0.5rem; background: none; border: none; color: white; cursor: pointer; font-weight: bold; }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Poppins', 'sans-serif'], display: ['Satisfy', 'cursive'], },
                    colors: { // ...
                        'fp-body-bg': '#E7F1D3', 'fp-primary-green': '#5AD479', 'fp-primary-green-dark': '#34C759',
                        'fp-accent-blue': '#5A6AD4', 'fp-accent-blue-dark': '#4755c4', 'fp-neutral-text': '#111827',
                        'fp-neutral-darkest': '#333333', 'fp-neutral-lightest': '#FBFDF8', 'fp-white': '#FFFFFF',
                        'fp-neutral-medium': '#D1D5DB', 'fp-neutral-light': '#F9FAFB', 'fp-neutral-text-light': '#6B7280',
                        'gray-100': '#f3f4f6',
                    }, // ...
                    boxShadow: { 'fp-cta': '0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06)', },
                    borderRadius: { 'fp': '0.5rem', }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-100">
    <div class="w-full max-w-[430px] sm:max-w-sm md:max-w-md lg:max-w-lg xl:max-w-xl 2xl:max-w-2xl mx-auto bg-fp-body-bg flex flex-col min-h-screen shadow-xl p-6">
        <header class="pt-10 pb-6"> 
            <a href="onboarding-people.html" class="text-fp-accent-blue hover:text-fp-accent-blue-dark inline-flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>
                Back
            </a>
            <h1 class="font-display-prototype text-3xl text-fp-neutral-darkest text-shadow-dark-prototype text-center mt-4">Allergies & Sensitivities?</h1>
        </header>

        <main class="flex-grow space-y-6 overflow-y-auto"> 
            <p class="text-fp-neutral-text text-center text-sm">Let us know about any food allergies or sensitivities for anyone in your household.</p>

            <div>
                <label for="allergies-input" class="block font-sans text-sm font-medium text-fp-neutral-darkest mb-1">Enter allergies (e.g., peanuts, gluten, shellfish)</label>
                <div class="flex gap-2 w-full">
                    <input type="text" id="allergies-input" placeholder="Type an allergy and press Enter"
                           class="flex-grow min-w-0 p-3 rounded-fp border border-fp-neutral-medium bg-fp-white shadow-sm focus:border-fp-primary-green focus:ring-1 focus:ring-fp-primary-green">
                    <button id="add-allergy-btn" class="px-4 py-2 bg-fp-accent-blue text-white rounded-fp hover:bg-fp-accent-blue-dark font-medium">Add</button>
                </div>
                <div id="allergy-tags-container" class="tag-input-container mt-2 min-h-[40px]">
                </div>
            </div>

            <div class="mt-4">
                <p class="block font-sans text-sm font-medium text-fp-neutral-darkest mb-2">Common Allergens (optional quick select):</p>
                <div class="grid grid-cols-2 gap-3"> 
                    <label class="flex items-center p-3 bg-fp-white rounded-fp border border-fp-neutral-medium hover:border-fp-primary-green has-[:checked]:border-fp-primary-green has-[:checked]:ring-1 has-[:checked]:ring-fp-primary-green">
                        <input type="checkbox" value="dairy" class="form-checkbox-custom common-allergy-checkbox mr-2">
                        <span class="text-sm text-fp-neutral-darkest">Dairy</span>
                    </label>
                    <label class="flex items-center p-3 bg-fp-white rounded-fp border border-fp-neutral-medium hover:border-fp-primary-green has-[:checked]:border-fp-primary-green has-[:checked]:ring-1 has-[:checked]:ring-fp-primary-green">
                        <input type="checkbox" value="eggs" class="form-checkbox-custom common-allergy-checkbox mr-2">
                        <span class="text-sm text-fp-neutral-darkest">Eggs</span>
                    </label>
                    <label class="flex items-center p-3 bg-fp-white rounded-fp border border-fp-neutral-medium hover:border-fp-primary-green has-[:checked]:border-fp-primary-green has-[:checked]:ring-1 has-[:checked]:ring-fp-primary-green">
                        <input type="checkbox" value="nuts" class="form-checkbox-custom common-allergy-checkbox mr-2">
                        <span class="text-sm text-fp-neutral-darkest">Tree Nuts</span>
                    </label>
                    <label class="flex items-center p-3 bg-fp-white rounded-fp border border-fp-neutral-medium hover:border-fp-primary-green has-[:checked]:border-fp-primary-green has-[:checked]:ring-1 has-[:checked]:ring-fp-primary-green">
                        <input type="checkbox" value="peanuts" class="form-checkbox-custom common-allergy-checkbox mr-2">
                        <span class="text-sm text-fp-neutral-darkest">Peanuts</span>
                    </label>
                     <label class="flex items-center p-3 bg-fp-white rounded-fp border border-fp-neutral-medium hover:border-fp-primary-green has-[:checked]:border-fp-primary-green has-[:checked]:ring-1 has-[:checked]:ring-fp-primary-green">
                        <input type="checkbox" value="shellfish" class="form-checkbox-custom common-allergy-checkbox mr-2">
                        <span class="text-sm text-fp-neutral-darkest">Shellfish</span>
                    </label>
                     <label class="flex items-center p-3 bg-fp-white rounded-fp border border-fp-neutral-medium hover:border-fp-primary-green has-[:checked]:border-fp-primary-green has-[:checked]:ring-1 has-[:checked]:ring-fp-primary-green">
                        <input type="checkbox" value="soy" class="form-checkbox-custom common-allergy-checkbox mr-2">
                        <span class="text-sm text-fp-neutral-darkest">Soy</span>
                    </label>
                     <label class="flex items-center p-3 bg-fp-white rounded-fp border border-fp-neutral-medium hover:border-fp-primary-green has-[:checked]:border-fp-primary-green has-[:checked]:ring-1 has-[:checked]:ring-fp-primary-green">
                        <input type="checkbox" value="gluten" class="form-checkbox-custom common-allergy-checkbox mr-2">
                        <span class="text-sm text-fp-neutral-darkest">Gluten</span>
                    </label>
                </div>
            </div>
             <p class="text-xs text-fp-neutral-text-light mt-6"> 
                If planning for multiple people, you can specify per-person allergies later in settings or if they join your plan.
            </p>
        </main>

        <footer class="pt-8 pb-6"> 
             <a href="onboarding-equipment.html" class="w-full text-center block font-semibold py-3 px-6 rounded-fp bg-fp-primary-green text-fp-white shadow-fp-cta hover:bg-fp-primary-green-dark">
                Next
            </a>
        </footer>
    </div>
    <script>
        // ... JavaScript for allergies tag input (remains unchanged) ...
        const allergyInput = document.getElementById('allergies-input');
        const addAllergyBtn = document.getElementById('add-allergy-btn');
        const tagsContainer = document.getElementById('allergy-tags-container');
        const commonAllergyCheckboxes = document.querySelectorAll('.common-allergy-checkbox');
        let allergies = [];

        function renderTags() {
            tagsContainer.innerHTML = '';
            allergies.forEach((allergy, index) => {
                const tag = document.createElement('span');
                tag.classList.add('tag');
                tag.textContent = allergy;
                const removeBtn = document.createElement('button');
                removeBtn.innerHTML = '×';
                removeBtn.onclick = () => {
                    allergies.splice(index, 1);
                    commonAllergyCheckboxes.forEach(cb => {
                        if (cb.value.toLowerCase() === allergy.toLowerCase()) {
                            cb.checked = false;
                        }
                    });
                    renderTags();
                };
                tag.appendChild(removeBtn);
                tagsContainer.appendChild(tag);
            });
        }

        function addAllergy(allergyText) {
            const newAllergy = allergyText.trim();
            if (newAllergy && !allergies.map(a => a.toLowerCase()).includes(newAllergy.toLowerCase())) {
                allergies.push(newAllergy);
                renderTags();
            }
        }

        addAllergyBtn.addEventListener('click', () => {
            addAllergy(allergyInput.value);
            allergyInput.value = '';
            allergyInput.focus();
        });

        allergyInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                addAllergy(allergyInput.value);
                allergyInput.value = '';
            }
        });

        commonAllergyCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', (e) => {
                const allergyValue = e.target.value;
                if (e.target.checked) {
                    addAllergy(allergyValue);
                } else {
                    const index = allergies.map(a => a.toLowerCase()).indexOf(allergyValue.toLowerCase());
                    if (index > -1) {
                        allergies.splice(index, 1);
                        renderTags();
                    }
                }
            });
        });
    </script>
</body>
</html>